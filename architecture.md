                                     DCN v2 Re-Ranker Architecture
                                     ===========================

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Input Features                                      │
├───────────────┬───────────────┬────────────────┬──────────────┬───────────────┤
│   Product     │    User       │     Geo        │  Country     │  Interaction   │
│  Embeddings   │  Embeddings   │    Features    │  Features    │   History     │
└───────┬───────┴───────┬───────┴───────┬────────┴──────┬───────┴───────┬───────┘
        │               │               │                │               │
┌───────▼───────┐ ┌─────▼─────┐ ┌──────▼──────┐ ┌──────▼──────┐ ┌─────▼─────┐
│   Feature     │ │  Feature   │ │    Text     │ │    Text     │ │ Sequence  │
│  Processing   │ │ Processing │ │  Embedder   │ │  Embedder   │ │  Encoder  │
└───────┬───────┘ └─────┬─────┘ └──────┬──────┘ └──────┬──────┘ └─────┬─────┘
        │               │               │                │               │
        └───────────────┴───────────────┴────────┬──────┴───────────────┘
                                                │
                                    ┌───────────▼────────────┐
                                    │    Feature Fusion      │
                                    └───────────┬────────────┘
                                                │
                              ┌─────────────────┴─────────────────┐
                              │                                   │
                     ┌────────▼──────────┐            ┌──────────▼─────────┐
                     │   Cross Network   │            │    Deep Network     │
                     │                   │            │                     │
                     │  Feature Crossing │            │ Non-linear Patterns │
                     │   (Low-rank DCN)  │            │   (MLP w/ Skip)    │
                     └────────┬──────────┘            └──────────┬─────────┘
                              │                                   │
                              └─────────────────┬─────────────────┘
                                               │
                                    ┌──────────▼───────────┐
                                    │    Feature Fusion    │
                                    └──────────┬───────────┘
                                               │
                                ┌──────────────┴──────────────┐
                                │        Task Heads           │
                        ┌───────┴──────┬────────┴───────┐
                        │              │                │
                   ┌────▼────┐    ┌────▼────┐     ┌────▼────┐
                   │  Click  │    │Purchase │     │Add to   │
                   │ Score   │    │ Score   │     │Cart     │
                   └─────────┘    └─────────┘     └─────────┘
``` 