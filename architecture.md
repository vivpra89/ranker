                                     DCN v2 Re-Ranker Architecture
                                     ===========================

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Input Features                                      │
├───────────────┬───────────────┬────────────────┬──────────────┬───────────────┤
│   Product     │    User       │     Geo        │  Country     │  Interaction   │
│  Embeddings   │  Embeddings   │   Features     │  Features    │   History     │
└───────┬───────┴───────┬───────┴───────┬────────┴──────┬───────┴───────┬───────┘
        │               │               │                │               │
        ▼               ▼               ▼                ▼               ▼
┌───────────────┐ ┌─────────────┐ ┌──────────────┐ ┌──────────────┐ ┌───────────┐
│   Feature     │ │  Feature    │ │    Text      │ │    Text      │ │ Sequence  │
│  Processing   │ │ Processing  │ │  Embedder    │ │  Embedder    │ │ Encoder   │
└───────┬───────┘ └─────┬───────┘ └──────┬───────┘ └──────┬───────┘ └─────┬─────┘
        │               │                 │                │               │
        └───────────────┴─────────────────┴────────┬──────┴───────────────┘
                                                  │
                                                  ▼
                                     ┌────────────────────────┐
                                     │   Feature Fusion       │
                                     │   & Normalization     │
                                     └──────────┬────────────┘
                                                │
                                                ▼
                               ┌────────────────────────────────┐
                               │      Combined Features         │
                               └──────────────┬─────────────────┘
                                             │
                              ┌──────────────┴──────────────┐
                              ▼                             ▼
                    ┌──────────────────┐         ┌───────────────────┐
                    │  Cross Network   │         │   Deep Network    │
                    │                  │         │                   │
                    │ Feature Crossing │         │ Non-linear       │
                    │ (Low-rank DCN)   │         │ Patterns (MLP)   │
                    └────────┬─────────┘         └────────┬────────┘
                            │                             │
                            └──────────────┬─────────────┘
                                          │
                                          ▼
                                ┌───────────────────┐
                                │  Feature Fusion   │
                                │  & Combination    │
                                └────────┬──────────┘
                                         │
                                         ▼
                                ┌───────────────────┐
                                │   Task Heads      │
                                └────────┬──────────┘
                                         │
                            ┌────────────┼────────────┐
                            ▼            ▼            ▼
                     ┌──────────┐  ┌──────────┐  ┌──────────┐
                     │  Click   │  │ Purchase │  │ Add to   │
                     │  Score   │  │  Score   │  │  Cart    │
                     └──────────┘  └──────────┘  └──────────┘
``` 